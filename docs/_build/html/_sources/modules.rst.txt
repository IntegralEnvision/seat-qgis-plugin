.. _modules:

Modules
=======

The behavior of the plugin depends on the input and is subdivided into 4 modules:
  
  1. **Shear Stress Module** - analysis of spatial change in bed mobility
  2. **Velocity Module** - analysis of spatial change in larval motility
  3. **Acoustics Module** - analysis of acoustic propagation and thresholds
  4. **Power Module** - analysis of power generated by WEC/CEC array


Velocity Module
---------------

The `velocity_module.py` script is a component of SEAT designed to assess the impact of velocity stressors on larval motility in aquatic environments.
It helps in understanding how different devices or conditions affect velocity by comparing scenarios with and without the devices or conditions present.

**Core Functions:**
-------------------

+------------------------------------+-----------------------------------------------------------------------+
| Function                           | Description                                                           |
+====================================+=======================================================================+
| ``classify_motility()``            | This function classifies larval motility into various categories such |
|                                    | as Reduced, Increased, or New Motility based on the comparison of     |
|                                    | device runs and baseline (no device) runs.                            |
+------------------------------------+-----------------------------------------------------------------------+
| ``check_grid_define_vars()``       | Determines the type of grid (structured/unstructured) and defines     |
|                                    | corresponding velocity and coordinate variable names.                 |
+------------------------------------+-----------------------------------------------------------------------+
| ``calculate_velocity_stressors()`` | Main function that loads data, performs calculations, and computes    |
|                                    | various metrics including velocity differences and motility           |
|                                    | classifications.                                                      |
+------------------------------------+-----------------------------------------------------------------------+
| ``run_velocity_stressor()``        | Creates GeoTIFFs and CSV files to visualize and quantify velocity     |
|                                    | changes and motility classifications.                                 |
+------------------------------------+-----------------------------------------------------------------------+



.. automodule:: seat.velocity_module
   :members:



### 3. **Input Data:**
   - NetCDF files containing velocity data for scenarios with and without devices present.
   - Optional: Receptor file containing critical velocity values, and probabilities/boundary condition file to weight different run scenarios.

### 4. **Output Data:**
   - GeoTIFF raster files visualizing velocity with and without devices, velocity changes, and motility classifications.
   - CSV files containing statistics of area changes and motility classifications.
   - These outputs help in assessing and visualizing the impact of velocity stressors on larval motility.

### 5. **Usage:**
   - Users need to specify the directory paths for model run NetCDF files (both with and without devices), and optionally the receptor and boundary condition files.
   - Run the `run_velocity_stressor()` function with the appropriate parameters to generate the output raster and CSV files.
   - The generated outputs can be used for further analysis or visualization to understand the spatial changes in larval motility due to velocity stressors.

### 6. **Customization:**
   - The module allows for customization by providing various parameters such as grid type, coordinate and velocity variable names, and output selection (MAX, MEAN, or LAST) to cater to different data structures and user preferences.

### 7. **Contact Information:**
   - The authors of this module are Timothy Nelson, Sam McWilliams, and Eben Pendelton, with provided email addresses for Timothy and Sam for further inquiries.

The Velocity Module is a crucial tool for ecological assessments in aquatic environments, aiding in understanding how human interventions or natural conditions could potentially impact larval motility, and by extension, the broader ecosystem. Through its structured functions and clear output files, it provides a robust platform for conducting such assessments in a systematic and visually interpretable manner.